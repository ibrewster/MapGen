L.Canvas.prototype._updateTriangle=function(layer){var p,ctx;if(!this._drawing||layer._empty())return null;p=layer._point;ctx=this._ctx;wh=layer._width/2;hh=layer._height/2;r=0!==layer._rotation?layer._rotation*(2*Math.PI)/360:0;this._layers[layer._leaflet_id]=layer;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(r);ctx.beginPath();ctx.moveTo(0,-hh);ctx.lineTo(wh,2*hh);ctx.lineTo(-wh,2*hh);ctx.closePath();ctx.restore();this._fillStroke(ctx,layer)},L.TriangleMarker=L.Path.extend({options:{fill:!0,width:12,height:12,rotation:0,renderer:L.canvas()},initialize:function(latlng,options){L.setOptions(this,options);this._latlng=L.latLng(latlng);this._width=this.options.width;this._height=this.options.height;this._rotation=this.options.rotation;this._renderer=this.options.renderer},setLatLng:function(latlng){this._latlng=L.latLng(latlng);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setWidth:function(width){this.options.width=this._width=width;return this.redraw()},setHeight:function(height){this.options.height=this._height=height;return this.redraw()},setRotation:function(deg){this.options.rotation=this._rotation=deg;return this.redraw()},getWidth:function(){return this._width},getHeight:function(){return this._height},getRotation:function(){return this._rotation},setStyle:function(options){var width=options&&options.width||this._width,height=options&&options.height||this._height;L.Path.prototype.setStyle.call(this,options);this.setWidth(width);this.setHeight(height);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var w=this._width/2,h=this._height/2,b=this._clickTolerance(),p=[w+b,h+b];this._pxBounds=new L.Bounds(this._point.subtract(p),this._point.add(p))},_update:function(){if(this._map)this._updatePath()},_updatePath:function(){this._renderer._updateTriangle(this)},_empty:function(){return this._width&&this._height&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(p){return this._pxBounds&&this._pxBounds.contains(p)}});L.triangleMarker=function(latlng,options){return new L.TriangleMarker(latlng,options)};